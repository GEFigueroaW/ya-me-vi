<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß TEST - Bot√≥n Evaluar Combinaci√≥n</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #1a1a1a; color: white; }
        .container { max-width: 800px; margin: 0 auto; background: #2a2a2a; padding: 20px; border-radius: 10px; }
        .test-section { background: #333; padding: 15px; margin: 10px 0; border-radius: 8px; }
        button { background: #00B44F; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin: 5px; cursor: pointer; }
        input { padding: 8px; margin: 2px; border: 1px solid #ccc; border-radius: 4px; text-align: center; width: 60px; }
        .error { color: #ff6b6b; }
        .success { color: #51cf66; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß DIAGN√ìSTICO - Bot√≥n Evaluar Combinaci√≥n</h1>
        
        <div class="test-section">
            <h3>üìã Test 1: Elementos DOM</h3>
            <div id="dom-test"></div>
        </div>
        
        <div class="test-section">
            <h3>üéØ Test 2: Simulaci√≥n de inputs</h3>
            <div>
                <input type="number" class="combo-input" min="1" max="56" placeholder="N1">
                <input type="number" class="combo-input" min="1" max="56" placeholder="N2">
                <input type="number" class="combo-input" min="1" max="56" placeholder="N3">
                <input type="number" class="combo-input" min="1" max="56" placeholder="N4">
                <input type="number" class="combo-input" min="1" max="56" placeholder="N5">
                <input type="number" class="combo-input" min="1" max="56" placeholder="N6">
            </div>
            <button id="evaluar-combinacion-btn">üéØ Evaluar Combinaci√≥n</button>
            <div id="resultado-combinacion" style="margin-top: 10px;"></div>
        </div>
        
        <div class="test-section">
            <h3>üìä Test 3: Carga de datos</h3>
            <div id="data-test"></div>
        </div>
        
        <div class="test-section">
            <h3>üîç Test 4: Event listeners</h3>
            <div id="event-test"></div>
        </div>
        
        <div class="test-section">
            <h3>üìù Console Log</h3>
            <div id="console-log" style="background: #1a1a1a; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;"></div>
        </div>
    </div>

    <script>
        // Funci√≥n para simular console.log y mostrarlo en la p√°gina
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        const consoleDiv = document.getElementById('console-log');
        
        function addToConsole(message, type = 'log') {
            const color = type === 'error' ? '#ff6b6b' : type === 'warn' ? '#ffd43b' : '#51cf66';
            consoleDiv.innerHTML += `<div style="color: ${color};">${new Date().toLocaleTimeString()}: ${message}</div>`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            addToConsole(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalConsoleError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };
        
        // Test 1: Verificar elementos DOM
        function testDOM() {
            const domTest = document.getElementById('dom-test');
            const elementos = [
                'evaluar-combinacion-btn',
                'resultado-combinacion'
            ];
            
            let html = '<ul>';
            elementos.forEach(id => {
                const element = document.getElementById(id);
                const status = element ? '‚úÖ' : '‚ùå';
                const className = element ? 'success' : 'error';
                html += `<li class="${className}">${status} ${id}: ${element ? 'Encontrado' : 'NO encontrado'}</li>`;
            });
            html += '</ul>';
            domTest.innerHTML = html;
        }
        
        // Test 2: Verificar que se pueden obtener los valores de los inputs
        function testInputs() {
            const inputs = document.querySelectorAll('.combo-input');
            console.log(`üìã Inputs encontrados: ${inputs.length}`);
            
            // Llenar con valores de prueba
            const valoresPrueba = [5, 12, 23, 34, 45, 56];
            inputs.forEach((input, index) => {
                input.value = valoresPrueba[index];
            });
            
            const numeros = Array.from(inputs).map(input => parseInt(input.value)).filter(num => !isNaN(num));
            console.log(`üéØ N√∫meros obtenidos: ${numeros.join(', ')}`);
            console.log(`‚úÖ Total n√∫meros v√°lidos: ${numeros.length}`);
        }
        
        // Test 3: Verificar carga de datos (simplificado)
        async function testDataLoading() {
            const dataTest = document.getElementById('data-test');
            try {
                console.log('üìä Intentando cargar datos de prueba...');
                // Simular carga de datos
                const response = await fetch('assets/Melate.csv');
                if (response.ok) {
                    console.log('‚úÖ archivo Melate.csv accesible');
                    dataTest.innerHTML = '<span class="success">‚úÖ CSV accesible</span>';
                } else {
                    console.log('‚ùå Error al acceder Melate.csv');
                    dataTest.innerHTML = '<span class="error">‚ùå CSV no accesible</span>';
                }
            } catch (error) {
                console.error('‚ùå Error de carga:', error.message);
                dataTest.innerHTML = '<span class="error">‚ùå Error de carga</span>';
            }
        }
        
        // Test 4: Event listeners
        function testEventListeners() {
            const eventTest = document.getElementById('event-test');
            const button = document.getElementById('evaluar-combinacion-btn');
            
            if (button) {
                button.addEventListener('click', function(e) {
                    console.log('üéØ Click detectado en bot√≥n evaluar');
                    const inputs = document.querySelectorAll('.combo-input');
                    const numeros = Array.from(inputs).map(input => parseInt(input.value)).filter(num => !isNaN(num));
                    
                    console.log(`üìã N√∫meros para evaluar: ${numeros.join(', ')}`);
                    
                    // Validaciones b√°sicas
                    if (numeros.length !== 6) {
                        console.error('‚ùå No hay 6 n√∫meros completos');
                        document.getElementById('resultado-combinacion').innerHTML = 
                            '<div style="color: #ff6b6b;">‚ùå Faltan n√∫meros. Completa los 6 campos.</div>';
                        return;
                    }
                    
                    const sinDuplicados = new Set(numeros);
                    if (sinDuplicados.size !== 6) {
                        console.error('‚ùå Hay n√∫meros duplicados');
                        document.getElementById('resultado-combinacion').innerHTML = 
                            '<div style="color: #ff6b6b;">‚ùå No se permiten n√∫meros duplicados.</div>';
                        return;
                    }
                    
                    if (numeros.some(n => n < 1 || n > 56)) {
                        console.error('‚ùå N√∫meros fuera de rango');
                        document.getElementById('resultado-combinacion').innerHTML = 
                            '<div style="color: #ff6b6b;">‚ùå Los n√∫meros deben estar entre 1 y 56.</div>';
                        return;
                    }
                    
                    console.log('‚úÖ Validaciones pasadas - bot√≥n funcionando correctamente');
                    document.getElementById('resultado-combinacion').innerHTML = 
                        '<div style="color: #51cf66;">‚úÖ ¬°Bot√≥n funcionando! Los datos ser√≠an enviados para an√°lisis.</div>';
                });
                
                eventTest.innerHTML = '<span class="success">‚úÖ Event listener agregado</span>';
                console.log('‚úÖ Event listener del bot√≥n configurado');
            } else {
                eventTest.innerHTML = '<span class="error">‚ùå Bot√≥n no encontrado</span>';
                console.error('‚ùå No se pudo encontrar el bot√≥n');
            }
        }
        
        // Ejecutar tests cuando la p√°gina cargue
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Iniciando diagn√≥stico...');
            testDOM();
            testInputs();
            testDataLoading();
            testEventListeners();
            console.log('‚úÖ Diagn√≥stico completado');
        });
    </script>
</body>
</html>
